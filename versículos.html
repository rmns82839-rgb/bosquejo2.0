<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Vers√≠culos Clave - Studio</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        :root { 
            --primary-gold: #f1c40f; 
            --dark-bg: #1e293b; 
            --accent-blue: #3498db; 
            --bible-color: #6d28d9; /* Un color p√∫rpura elegante para Bible.com */
        }
        
        body { background-color: #f8fafc !important; font-family: 'Times New Roman', serif; }
        .header-versiculos { background: var(--dark-bg); color: white; padding: 25px 0; border-bottom: 5px solid var(--primary-gold); }
        
        .card-versiculo { 
            background: white; border: none; border-radius: 15px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.05); transition: 0.3s;
            margin-bottom: 20px; overflow: hidden;
        }
        .card-versiculo:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        
        .ref-biblica { color: var(--accent-blue); font-weight: bold; font-size: 1.1rem; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .texto-biblico { font-style: italic; font-size: 1.2rem; color: #334155; line-height: 1.6; }
        
        /* Estilo del Recordatorio */
        .reminder-box {
            background: #fff3cd; border: 1px solid #ffeeba; border-radius: 10px;
            padding: 10px 20px; margin-bottom: 20px; display: flex; 
            align-items: center; justify-content: space-between;
        }
        .form-check-input:checked { background-color: #198754; border-color: #198754; }

        .btn-accion { border-radius: 10px; font-weight: bold; transition: 0.3s; }

        /* Bot√≥n personalizado de Bible.com */
        .btn-bible { background-color: var(--bible-color); color: white; border: none; }
        .btn-bible:hover { background-color: #5b21b6; color: white; transform: scale(1.05); }
    </style>
</head>
<body>

<header class="header-versiculos no-print shadow">
    <div class="container-fluid px-4 d-flex flex-wrap justify-content-between align-items-center gap-3">
        <div>
            <h1 class="h3 mb-0">üìë Vers√≠culos Clave</h1>
            <small class="opacity-75">Memorizaci√≥n y Cimentaci√≥n B√≠blica</small>
        </div>
        <div class="d-flex gap-2 align-items-center">
            <a href="https://bible.com" target="_blank" class="btn btn-bible btn-sm btn-accion">üìñ Bible.com</a>
            
            <div class="vr mx-1 text-white opacity-25"></div> <a href="index.html" class="btn btn-outline-light btn-sm btn-accion">üîô Volver</a>
            <button class="btn btn-warning btn-sm btn-accion" onclick="nuevoVersiculo()">+ A√±adir</button>
        </div>
    </div>
</header>

<div class="container-fluid px-4 mt-4">
    <div class="reminder-box shadow-sm">
        <div>
            <strong>üîî Recordatorio de Memorizaci√≥n</strong>
            <div class="small text-muted">Te avisar√© a las 11am, 3pm y 8pm para leer tus vers√≠culos.</div>
        </div>
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="switchAlerta" onchange="toggleAlerta(this.checked)">
            <label class="form-check-label fw-bold" for="switchAlerta" id="labelAlerta">OFF</label>
        </div>
    </div>

    <input type="text" id="busqueda" class="form-control form-control-lg shadow-sm mb-4" placeholder="üîç Buscar por palabra o libro..." onkeyup="filtrar()">

    <div id="contenedorVersiculos" class="row"></div>

    <div id="vacio" class="text-center p-5" style="display:none;">
        <h4 class="text-muted">No hay vers√≠culos guardados.</h4>
        <p>Presiona el bot√≥n + para empezar tu colecci√≥n.</p>
    </div>
</div>

<script>
    let versiculos = JSON.parse(localStorage.getItem('mis_versiculos_v1')) || [];
    let alertaActiva = JSON.parse(localStorage.getItem('alerta_memorizacion')) || false;

    function cargar() {
        const c = document.getElementById('contenedorVersiculos');
        const v = document.getElementById('vacio');
        c.innerHTML = "";
        
        if (versiculos.length === 0) { v.style.display = "block"; return; }
        v.style.display = "none";

        versiculos.forEach((item, i) => {
            c.innerHTML += `
                <div class="col-12 col-md-6 col-lg-4 item-v">
                    <div class="card card-versiculo p-4">
                        <div class="ref-biblica d-flex justify-content-between">
                            <span>üìñ ${item.cita}</span>
                            <div class="no-print">
                                <button class="btn btn-link btn-sm text-primary p-0" onclick="editar(${i})">‚úèÔ∏è</button>
                                <button class="btn btn-link btn-sm text-danger p-0 ms-2" onclick="borrar(${i})">üóëÔ∏è</button>
                            </div>
                        </div>
                        <div class="texto-biblico mt-3">"${item.texto}"</div>
                        <div class="mt-3 small text-uppercase text-muted fw-bold" style="letter-spacing:1px; font-size:0.7rem;">
                            Categor√≠a: ${item.tag || 'General'}
                        </div>
                    </div>
                </div>`;
        });
        
        document.getElementById('switchAlerta').checked = alertaActiva;
        document.getElementById('labelAlerta').innerText = alertaActiva ? "ON" : "OFF";
    }

    function nuevoVersiculo() {
        const cita = prompt("Cita B√≠blica (Ej: Juan 3:16):"); if(!cita) return;
        const texto = prompt("Texto del vers√≠culo:"); if(!texto) return;
        const tag = prompt("Etiqueta (Ej: Promesa, Fe, Gracia):") || "General";
        versiculos.unshift({cita, texto, tag});
        guardar();
    }

    function editar(i) {
        versiculos[i].cita = prompt("Cita:", versiculos[i].cita) || versiculos[i].cita;
        versiculos[i].texto = prompt("Texto:", versiculos[i].texto) || versiculos[i].texto;
        versiculos[i].tag = prompt("Etiqueta:", versiculos[i].tag) || versiculos[i].tag;
        guardar();
    }

    function borrar(i) { if(confirm("¬øEliminar este vers√≠culo?")) { versiculos.splice(i,1); guardar(); } }
    function guardar() { localStorage.setItem('mis_versiculos_v1', JSON.stringify(versiculos)); cargar(); }

    function filtrar() {
        const t = document.getElementById('busqueda').value.toLowerCase();
        document.querySelectorAll('.item-v').forEach(it => {
            it.style.display = it.innerText.toLowerCase().includes(t) ? "block" : "none";
        });
    }

    // --- SISTEMA DE ALERTAS CORREGIDO ---
    function toggleAlerta(valor) {
        alertaActiva = valor;
        localStorage.setItem('alerta_memorizacion', JSON.stringify(valor));
        document.getElementById('labelAlerta').innerText = valor ? "ON" : "OFF";
        if(valor) alert("¬°Activado! Recibir√°s alertas a las 11am, 3pm y 8pm.");
    }

    function verificarHora() {
        if (!alertaActiva) return;
        
        const ahora = new Date();
        const hora = ahora.getHours();
        const minutos = ahora.getMinutes();
        const segundos = ahora.getSeconds();

        // Horas: 11 (11am), 15 (3pm), 20 (8pm)
        const horasAlerta = [11, 15, 20];

        if (horasAlerta.includes(hora) && minutos === 0 && segundos === 0) {
            alert("‚ú® MOMENTO DE MEMORIZAR ‚ú®\n\n'La palabra de Cristo more en abundancia en vosotros'.\n\nEs hora de leer tus vers√≠culos (3 veces). ¬°√Ånimo!");
        }
    }

    setInterval(verificarHora, 1000);
    window.onload = cargar;
</script>
</body>
</html>
